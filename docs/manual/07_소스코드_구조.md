# 케어매치(CareMatch) V3 소스코드 구조

---

## 문서 정보

| 항목 | 내용 |
|------|------|
| 프로젝트명 | 케어매치(CareMatch) V3 |
| 문서버전 | 1.0 |
| 작성일자 | 2026년 1월 2일 |
| 저장소 | https://github.com/saintgo7/app-hospital-yoyang |

---

## 목차

1. [프로젝트 구조](#1-프로젝트-구조)
2. [디렉토리 상세 설명](#2-디렉토리-상세-설명)
3. [주요 파일 설명](#3-주요-파일-설명)
4. [코딩 컨벤션](#4-코딩-컨벤션)
5. [의존성 목록](#5-의존성-목록)

---

## 1. 프로젝트 구조

```
carematch-v3/
├── .claude/                     # Claude Code 설정
│   └── settings.json
├── docs/                        # 문서
│   ├── agents/                  # 에이전트 프롬프트
│   ├── dev-logs/                # 개발 로그
│   ├── manual/                  # 납품 문서
│   ├── mcp/                     # MCP 설정
│   ├── phases/                  # 개발 단계 가이드
│   └── skills/                  # Skills 설정
├── public/                      # 정적 파일
│   ├── favicon.ico
│   ├── manifest.json
│   └── robots.txt
├── src/                         # 소스 코드
│   ├── components/              # React 컴포넌트
│   ├── hooks/                   # 커스텀 훅
│   ├── lib/                     # 라이브러리/유틸
│   ├── pages/                   # 페이지 (Pages Router)
│   ├── styles/                  # 스타일
│   └── types/                   # TypeScript 타입
├── .env.example                 # 환경 변수 예시
├── .env.local                   # 로컬 환경 변수 (git 제외)
├── .eslintrc.json               # ESLint 설정
├── .gitignore                   # Git 제외 파일
├── CLAUDE.md                    # Claude Code 지침
├── next.config.js               # Next.js 설정
├── package.json                 # 패키지 정보
├── pnpm-lock.yaml               # 의존성 잠금
├── postcss.config.mjs           # PostCSS 설정
├── tailwind.config.ts           # Tailwind CSS 설정
├── tsconfig.json                # TypeScript 설정
└── vercel.json                  # Vercel 배포 설정
```

---

## 2. 디렉토리 상세 설명

### 2.1 src/components/

UI 컴포넌트를 포함합니다.

```
components/
├── layout/                      # 레이아웃 컴포넌트
│   ├── index.tsx                # Layout 래퍼 (export)
│   ├── Header.tsx               # 헤더 (네비게이션, 로그인 상태)
│   └── Footer.tsx               # 푸터 (링크, 저작권)
│
├── ui/                          # shadcn/ui 기반 UI 컴포넌트
│   ├── avatar.tsx               # 아바타
│   ├── badge.tsx                # 배지
│   ├── button.tsx               # 버튼
│   ├── card.tsx                 # 카드
│   ├── input.tsx                # 입력 필드
│   ├── label.tsx                # 레이블
│   └── textarea.tsx             # 텍스트 영역
│
└── common/                      # 공통 비즈니스 컴포넌트
    ├── ReviewCard.tsx           # 리뷰 카드
    └── ReviewForm.tsx           # 리뷰 작성 폼
```

### 2.2 src/pages/

Next.js Pages Router 기반 페이지 파일입니다.

```
pages/
├── _app.tsx                     # App 컴포넌트 (Provider 설정)
├── _document.tsx                # Document (HTML 설정)
├── index.tsx                    # 홈페이지 (/)
├── dashboard.tsx                # 대시보드 리다이렉트
│
├── auth/                        # 인증 관련 페이지
│   ├── login.tsx                # 로그인
│   ├── register.tsx             # 회원가입 (역할 선택)
│   ├── complete-profile.tsx     # 프로필 완성
│   └── error.tsx                # 인증 에러
│
├── caregiver/                   # 간병인 전용 페이지
│   ├── dashboard.tsx            # 간병인 대시보드
│   ├── profile.tsx              # 프로필 관리
│   └── applications.tsx         # 지원 현황
│
├── guardian/                    # 보호자 전용 페이지
│   ├── dashboard.tsx            # 보호자 대시보드
│   └── jobs/
│       ├── index.tsx            # 내 구인글 목록
│       ├── new.tsx              # 구인글 등록
│       └── [id].tsx             # 구인글 상세/수정
│
├── jobs/                        # 구인글 (공개)
│   ├── index.tsx                # 구인글 목록
│   └── [id].tsx                 # 구인글 상세
│
├── chat/                        # 채팅
│   ├── index.tsx                # 채팅방 목록
│   └── [roomId].tsx             # 채팅방
│
├── reviews/                     # 리뷰
│   ├── index.tsx                # 리뷰 목록
│   └── write/[jobId].tsx        # 리뷰 작성
│
└── api/                         # API 라우트
    ├── auth/[...nextauth].ts    # NextAuth.js 핸들러
    ├── users/complete-profile.ts
    ├── caregiver/profile.ts
    ├── jobs/index.ts
    ├── guardian/jobs/[id].ts
    ├── applications/index.ts
    ├── applications/[id].ts
    ├── reviews/index.ts
    ├── sitemap.ts
    └── chat/
        ├── rooms.ts
        └── rooms/[roomId]/messages.ts
```

### 2.3 src/lib/

라이브러리 및 유틸리티 함수입니다.

```
lib/
├── supabase.ts                  # Supabase 클라이언트
│   - createClient()             # 서버 측 클라이언트
│   - createBrowserClient()      # 브라우저 측 클라이언트
│
├── auth.ts                      # NextAuth.js 설정
│   - authOptions                # 인증 옵션
│   - KakaoProvider              # 카카오 OAuth
│   - NaverProvider              # 네이버 OAuth
│
├── kakao.ts                     # 카카오 알림톡
│   - sendAlimtalk()             # 알림톡 발송
│   - templates                  # 메시지 템플릿
│
└── utils.ts                     # 유틸리티 함수
    - cn()                       # 클래스 병합 (tailwind-merge)
```

### 2.4 src/types/

TypeScript 타입 정의입니다.

```
types/
└── index.ts
    - User                       # 사용자 타입
    - CaregiverProfile           # 간병인 프로필
    - JobPosting                 # 구인글
    - Application                # 지원
    - Review                     # 리뷰
    - ChatRoom                   # 채팅방
    - Message                    # 메시지
```

### 2.5 src/styles/

스타일 파일입니다.

```
styles/
└── globals.css                  # 전역 CSS
    - Tailwind directives        # @tailwind base/components/utilities
    - CSS Variables              # 색상, 테마 변수
    - Base styles                # 기본 스타일
```

---

## 3. 주요 파일 설명

### 3.1 설정 파일

#### next.config.js

```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  reactStrictMode: true,
  images: {
    remotePatterns: [
      { hostname: 'k.kakaocdn.net' },      // 카카오 프로필
      { hostname: 'ssl.pstatic.net' },     // 네이버 프로필
      { hostname: '*.supabase.co' },       // Supabase Storage
    ],
  },
  // 성능 최적화
  experimental: {
    optimizePackageImports: ['@supabase/supabase-js'],
  },
}

module.exports = nextConfig
```

#### tailwind.config.ts

```typescript
import type { Config } from 'tailwindcss'

const config: Config = {
  darkMode: ['class'],
  content: [
    './src/pages/**/*.{js,ts,jsx,tsx,mdx}',
    './src/components/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    container: {
      center: true,
      padding: '2rem',
      screens: { '2xl': '1400px' },
    },
    extend: {
      colors: {
        // CSS 변수 기반 색상
        border: 'hsl(var(--border))',
        background: 'hsl(var(--background))',
        foreground: 'hsl(var(--foreground))',
        primary: {
          DEFAULT: 'hsl(var(--primary))',
          foreground: 'hsl(var(--primary-foreground))',
        },
        // ... 추가 색상
      },
    },
  },
  plugins: [require('tailwindcss-animate')],
}

export default config
```

#### tsconfig.json

```json
{
  "compilerOptions": {
    "target": "es5",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "forceConsistentCasingInFileNames": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx"],
  "exclude": ["node_modules"]
}
```

### 3.2 핵심 소스 파일

#### src/lib/supabase.ts

```typescript
import { createClient as createSupabaseClient } from '@supabase/supabase-js'

const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!
const supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY!

// 서버 측 클라이언트 (서비스 롤)
export const supabase = createSupabaseClient(supabaseUrl, supabaseServiceKey)

// 브라우저 측 클라이언트 (익명 키)
export const createBrowserClient = () =>
  createSupabaseClient(supabaseUrl, supabaseAnonKey)
```

#### src/lib/auth.ts

```typescript
import { NextAuthOptions } from 'next-auth'
import KakaoProvider from 'next-auth/providers/kakao'
import NaverProvider from 'next-auth/providers/naver'
import { supabase } from './supabase'

export const authOptions: NextAuthOptions = {
  providers: [
    KakaoProvider({
      clientId: process.env.KAKAO_CLIENT_ID!,
      clientSecret: process.env.KAKAO_CLIENT_SECRET!,
    }),
    NaverProvider({
      clientId: process.env.NAVER_CLIENT_ID!,
      clientSecret: process.env.NAVER_CLIENT_SECRET!,
    }),
  ],
  callbacks: {
    async signIn({ user, account }) {
      // 사용자 DB 저장/조회 로직
    },
    async session({ session, token }) {
      // 세션에 사용자 정보 추가
    },
    async jwt({ token, user }) {
      // JWT 토큰 처리
    },
  },
  pages: {
    signIn: '/auth/login',
    error: '/auth/error',
  },
}
```

#### src/types/index.ts

```typescript
export interface User {
  id: string
  email: string
  name: string
  role: 'caregiver' | 'guardian'
  phone?: string
  image?: string
  profile_completed: boolean
  created_at: string
  updated_at: string
}

export interface CaregiverProfile {
  id: string
  user_id: string
  experience_years?: number
  certifications?: string[]
  introduction?: string
  preferred_location?: string
  preferred_salary?: number
  available: boolean
  created_at: string
  updated_at: string
}

export interface JobPosting {
  id: string
  guardian_id: string
  title: string
  description: string
  location: string
  salary: number
  work_type: 'live_in' | 'commute' | 'hourly'
  patient_condition?: string
  status: 'open' | 'closed' | 'filled'
  created_at: string
  updated_at: string
  guardian?: User
}

// ... 추가 타입 정의
```

---

## 4. 코딩 컨벤션

### 4.1 파일 명명 규칙

| 유형 | 규칙 | 예시 |
|------|------|------|
| 컴포넌트 | PascalCase | `Header.tsx`, `JobCard.tsx` |
| 페이지 | kebab-case | `complete-profile.tsx` |
| 유틸리티 | camelCase | `supabase.ts`, `utils.ts` |
| 타입 | index.ts 또는 PascalCase | `types/index.ts` |

### 4.2 컴포넌트 구조

```typescript
// 1. 임포트
import { type FC } from 'react'
import { cn } from '@/lib/utils'

// 2. 타입 정의
interface Props {
  title: string
  className?: string
}

// 3. 컴포넌트 정의
export const Component: FC<Props> = ({ title, className }) => {
  // 4. 훅 사용
  // 5. 핸들러 정의
  // 6. 렌더링
  return (
    <div className={cn('base-class', className)}>
      {title}
    </div>
  )
}
```

### 4.3 API 라우트 구조

```typescript
import type { NextApiRequest, NextApiResponse } from 'next'
import { getServerSession } from 'next-auth'
import { authOptions } from '@/lib/auth'
import { supabase } from '@/lib/supabase'

export default async function handler(
  req: NextApiRequest,
  res: NextApiResponse
) {
  // 1. 인증 확인
  const session = await getServerSession(req, res, authOptions)
  if (!session) {
    return res.status(401).json({ error: '로그인이 필요합니다' })
  }

  // 2. HTTP 메서드별 처리
  switch (req.method) {
    case 'GET':
      return handleGet(req, res, session)
    case 'POST':
      return handlePost(req, res, session)
    default:
      res.setHeader('Allow', ['GET', 'POST'])
      return res.status(405).end(`Method ${req.method} Not Allowed`)
  }
}
```

---

## 5. 의존성 목록

### 5.1 주요 의존성

| 패키지 | 버전 | 용도 |
|--------|------|------|
| next | 15.5.9 | React 프레임워크 |
| react | 19.x | UI 라이브러리 |
| typescript | 5.x | 타입 시스템 |
| tailwindcss | 3.4.x | CSS 프레임워크 |
| @supabase/supabase-js | latest | Supabase 클라이언트 |
| next-auth | 4.x | 인증 라이브러리 |
| class-variance-authority | latest | 컴포넌트 변형 |
| clsx | latest | 조건부 클래스 |
| tailwind-merge | latest | Tailwind 클래스 병합 |
| tailwindcss-animate | latest | 애니메이션 |

### 5.2 개발 의존성

| 패키지 | 버전 | 용도 |
|--------|------|------|
| @types/node | latest | Node.js 타입 |
| @types/react | latest | React 타입 |
| eslint | 8.x | 코드 린터 |
| eslint-config-next | latest | Next.js ESLint 설정 |
| postcss | latest | CSS 후처리 |

### 5.3 설치 명령

```bash
# 전체 의존성 설치
pnpm install

# 새 의존성 추가
pnpm add [패키지명]

# 개발 의존성 추가
pnpm add -D [패키지명]
```

---

*본 문서는 케어매치 V3의 소스코드 구조를 설명합니다.*
